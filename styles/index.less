/*
Material-inspired UI layer for DARK-VIBE.
*/
@import "ui-variables";

@mui-surface-1: lighten(@background-primary, 4%);
@mui-surface-2: lighten(@background-primary, 7%);
@mui-surface-3: lighten(@background-primary, 10%);
@mui-outline: fade(#ffffff, 12%);
@mui-state-hover: fade(@accent-primary, 12%);
@mui-state-focus: fade(@accent-primary, 18%);
@mui-elevation-1: 0 1px 2px rgba(0, 0, 0, 0.36);
@mui-elevation-2: 0 6px 14px rgba(0, 0, 0, 0.34);
@mui-elevation-3: 0 14px 26px rgba(0, 0, 0, 0.34);

@thread-selected-gradient: linear-gradient(
  90deg,
  fade(lighten(@accent-primary, 7%), 40%) 0%,
  fade(@accent-primary, 26%) 38%,
  fade(darken(@accent-primary, 8%), 12%) 74%,
  fade(@accent-primary, 0%) 100%
);

body,
.sheet-frame {
  font-family: @font-family;
  font-size: @font-size-base;
  color: @text-color;
  background: linear-gradient(180deg, @background-primary 0%, #101216 100%);
  -webkit-font-smoothing: antialiased;
}

.sheet-toolbar {
  border-bottom: 1px solid @mui-outline;
  background: linear-gradient(180deg, @mui-surface-2 0%, @mui-surface-1 100%);
  box-shadow: @mui-elevation-1;
  z-index: 10;
}

.panel {
  border-right: 1px solid @mui-outline;
  background: linear-gradient(180deg, @background-off-primary 0%, @background-primary 100%);
}

.thread-icon:not(.thread-icon-unread):not(.thread-icon-star),
img.content-dark,
img.content-light {
  -webkit-filter: invert(100%) brightness(96%);
}

.mail-label {
  -webkit-filter: contrast(105%) brightness(92%);
}

#message-list .message-item-wrap .message-item-white-wrap {
  border: 1px solid fade(#ffffff, 10%);
  border-radius: @border-radius-base;
  background: linear-gradient(180deg, @mui-surface-1 0%, @background-secondary 100%);
  box-shadow: @mui-elevation-1;
  transition:
    box-shadow 0.16s ease,
    transform 0.16s ease,
    border-color 0.16s ease;

  &:hover {
    border-color: fade(@accent-primary, 34%);
    box-shadow: @mui-elevation-2;
    transform: translateY(-1px);
  }
}

.thread-list .list-item:not(.unread):not(.selected):not(.focused) {
  color: fade(@text-color, 76%);
}

.thread-list .list-item,
.draft-list .list-item {
  border-bottom-color: fade(#ffffff, 8%);
  background-color: @list-bg;
}

.list-item {
  transition:
    background-color 0.14s ease,
    background-image 0.14s ease,
    box-shadow 0.14s ease;

  &:hover:not(.selected):not(.focused) {
    background-color: @mui-state-hover !important;
  }
}

// Keep clicked row in a gradient state even when Mailspring swaps selected/focused classes.
.list-item.selected {
  background-color: transparent !important;
  background-image: @thread-selected-gradient !important;
  background-repeat: no-repeat !important;
  background-size: 100% 100% !important;
}

.thread-list .list-item.selected,
.thread-list .list-item.selected:hover,
.thread-list .list-item.selected.focused,
.thread-list .list-item.focused.selected,
.thread-list .list-item.focused,
.thread-list .list-item.focused:hover {
  background-color: transparent !important;
  background-image: @thread-selected-gradient !important;
  background-repeat: no-repeat !important;
  background-size: 100% 100% !important;
  box-shadow:
    inset 3px 0 0 @accent-primary,
    inset 0 0 0 1px fade(@accent-primary, 24%);
}

.thread-list.handler-split .list-item.selected,
.thread-list.handler-split .list-item.selected:hover,
.thread-list.handler-split .list-item.selected.focused,
.thread-list.handler-split .list-item.focused.selected,
.thread-list.handler-split .list-item.focused,
.thread-list.handler-split .list-item.focused:hover {
  background-color: transparent !important;
  background-image: @thread-selected-gradient !important;
  background-repeat: no-repeat !important;
  background-size: 100% 100% !important;
}

.thread-list.handler-split .list-item.selected:hover .list-column-HoverActions .inner,
.thread-list.handler-split
  .list-item.selected.focused:hover
  .list-column-HoverActions
  .inner,
.thread-list .list-item.focused:hover .list-column-HoverActions .inner,
.thread-list.handler-split
  .list-item.focused:hover
  .list-column-HoverActions
  .inner {
  background-image: linear-gradient(
    to right,
    fade(lighten(@accent-primary, 6%), 0%) 0%,
    fade(@accent-primary, 22%) 50%,
    fade(darken(@accent-primary, 6%), 10%) 100%
  ) !important;
}

// Higher specificity than native list-tabular selected/focused row styles.
body .thread-list .list-container .list-item.selected,
body .thread-list .list-container .list-item.selected:hover,
body .thread-list .list-container .list-item.focused,
body .thread-list .list-container .list-item.focused:hover,
body .thread-list.handler-split .list-container .list-item.selected,
body .thread-list.handler-split .list-container .list-item.selected:hover,
body .thread-list.handler-split .list-container .list-item.focused,
body .thread-list.handler-split .list-container .list-item.focused:hover {
  background-color: transparent !important;
  background-image: @thread-selected-gradient !important;
  background-repeat: no-repeat !important;
  background-size: 100% 100% !important;
}

// Ensure internal row blocks don't repaint over the selected gradient.
.thread-list .list-item.selected > *,
.thread-list .list-item.selected:hover > *,
.thread-list .list-item.selected.focused > *,
.thread-list .list-item.focused.selected > *,
.thread-list .list-item.focused > *,
.thread-list .list-item.focused:hover > *,
.thread-list .list-item.selected .list-column,
.thread-list .list-item.selected:hover .list-column,
.thread-list .list-item.selected.focused .list-column,
.thread-list .list-item.focused.selected .list-column,
.thread-list .list-item.focused .list-column,
.thread-list .list-item.focused:hover .list-column {
  background-color: transparent !important;
  background-image: none !important;
}

.btn {
  border-radius: @border-radius-base;
  border: 1px solid fade(#ffffff, 11%);
  background: linear-gradient(180deg, @mui-surface-3 0%, @mui-surface-1 100%);
  box-shadow: @mui-elevation-1;
  transition:
    transform 0.14s ease,
    box-shadow 0.14s ease,
    border-color 0.14s ease,
    background-color 0.14s ease;

  &:hover {
    transform: translateY(-1px);
    box-shadow: @mui-elevation-2;
    border-color: fade(@accent-primary, 44%);
  }
}

.btn.btn-emphasis {
  border: 1px solid fade(lighten(@accent-primary, 8%), 55%);
  background: linear-gradient(
    180deg,
    lighten(@accent-primary, 7%) 0%,
    @accent-primary 52%,
    darken(@accent-primary, 5%) 100%
  );
  color: @text-color-inverse;
  box-shadow:
    0 0 0 1px fade(@accent-primary, 28%),
    0 8px 22px fade(@accent-primary, 36%);
}

.editable.ProseMirror.is-focused,
input[type="text"]:focus,
textarea:focus {
  border-color: fade(lighten(@accent-primary, 8%), 70%);
  background-color: mix(@input-bg, @accent-primary, 94%);
  box-shadow:
    0 0 0 3px @mui-state-focus,
    0 0 0 1px fade(@accent-primary, 70%);
}

h1,
.sheet-title {
  font-size: @font-size-h1;
  font-weight: 500;
  line-height: @line-height-heading;
  letter-spacing: 0.01em;
  color: @text-color-heading;
}

h2 {
  font-size: @font-size-h2;
  font-weight: 500;
  line-height: @line-height-heading;
  color: @text-color-heading;
}

h3,
.section-title {
  font-size: @font-size-h3;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: @text-color-subtle;
}

.thread-subject {
  font-size: @font-size-lg;
  font-weight: 500;
  color: @text-color;
}

.message-item-subject {
  font-size: 15px;
}

.composer-sheet {
  background: @mui-surface-1;
  border-radius: @border-radius-large;
  box-shadow: @mui-elevation-2;
  overflow: hidden;

  .composer-header {
    background: linear-gradient(180deg, @mui-surface-2 0%, @mui-surface-1 100%);
    padding: 14px 18px;
    border-bottom: 1px solid @mui-outline;
  }

  .composer-recipients {
    .tokenizing-field .token,
    .div-tokenizing-field .token {
      background: linear-gradient(
        180deg,
        lighten(@accent-primary, 6%) 0%,
        @accent-primary 100%
      );
      color: @text-color-inverse;
      border-radius: 999px;
      border: 1px solid fade(lighten(@accent-primary, 14%), 46%);
      box-shadow: 0 2px 8px fade(@accent-primary, 32%);
      font-weight: 500;
    }
  }

  .composer-body {
    padding: 18px;
    background: @background-primary;

    .ProseMirror {
      color: @text-color;
      line-height: 1.6;
    }
  }

  .composer-action-bar-wrap {
    background: @mui-surface-1;
    border-top: 1px solid @mui-outline;
  }
}

a {
  color: @text-color-link;
  transition: color 0.14s ease;

  &:hover {
    color: lighten(@text-color-link, 10%);
  }
}

@keyframes muiFadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message-list-wrap {
  animation: muiFadeIn 0.28s ease-out;
}
